(()=>{var e={};e.id=5407,e.ids=[5407],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},52298:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>c}),a(1845),a(32694),a(71363);var t=a(36576),r=a(72007),n=a(21818),l=a.n(n),i=a(88897),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(s,d);let c=["",{children:["settings",{children:["database",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1845)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/settings/database/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,32694)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,71363,23)),"next/dist/client/components/not-found-error"]}],o=["/home/ubuntu/supermarket_pos_system/nextjs_space/app/settings/database/page.tsx"],m="/settings/database/page",x={require:a,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/settings/database/page",pathname:"/settings/database",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},48492:(e,s,a)=>{Promise.resolve().then(a.bind(a,11494))},11494:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var t=a(62901),r=a(24383),n=a(84700),l=a(92861),i=a(23415),d=a(73735),c=a(12458),o=a(27878),m=a(250),x=a(82657),p=a(23803),h=a(43921),u=a(71945);let g=(0,u.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),j=(0,u.Z)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var y=a(85453),f=a(42594);let b=(0,u.Z)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),v=(0,u.Z)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);var N=a(10333),w=a(10780);let k=(0,u.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function C(){let{data:e}=(0,n.useSession)()||{},[s,a]=(0,r.useState)(!1),[u,C]=(0,r.useState)({host:"localhost",port:"5432",database:"supermarket_pos",username:"postgres",password:""}),[S,_]=(0,r.useState)(!1),[Z,P]=(0,r.useState)(!1),[A,F]=(0,r.useState)(null),[D,q]=(0,r.useState)(!1),[I,R]=(0,r.useState)(null),M=async()=>{_(!0),F(null);try{let e=Date.now(),s=await fetch("/api/settings/database/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),a=Date.now()-e,t=await s.json();F({connected:t.success,message:t.message,latency:a}),t.success?h.Am.success("Connection successful!"):h.Am.error(t.message)}catch(e){F({connected:!1,message:"Failed to test connection"}),h.Am.error("Failed to test connection")}finally{_(!1)}},O=async()=>{if(!s){h.Am.error("Database settings can only be saved in desktop app");return}P(!0);try{if(await window.electronAPI.saveDbConfig({config:u,useLocalDb:D}),D&&A?.connected){let e=await fetch("/api/settings/database/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),s=await e.json();if(!s.success){h.Am.error("Failed to initialize database: "+s.message);return}}h.Am.success("Database configuration saved!")}catch(e){h.Am.error("Failed to save configuration")}finally{P(!1)}};return t.jsx(d.I,{children:t.jsx(c.p,{allowedRoles:["ADMIN"],children:(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx(l.W,{}),t.jsx(i.FE,{children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx(g,{className:"h-8 w-8 text-primary"}),(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Database Settings"}),t.jsx("p",{className:"text-muted-foreground",children:"Configure your database connection"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(p.Zb,{className:`cursor-pointer transition-all ${D?"hover:border-primary/50":"ring-2 ring-primary"}`,onClick:()=>q(!1),children:[(0,t.jsxs)(p.Ol,{className:"pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(j,{className:"h-5 w-5 text-blue-500"}),t.jsx(p.ll,{className:"text-lg",children:"Cloud Database"})]}),t.jsx(p.SZ,{children:"Connect to central cloud server for multi-location sync"})]}),t.jsx(p.aY,{children:t.jsx("div",{className:"flex items-center gap-2 text-sm",children:I?.connected?(0,t.jsxs)(t.Fragment,{children:[t.jsx(y.Z,{className:"h-4 w-4 text-green-500"})," Connected (",I.latency,"ms)"]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(f.Z,{className:"h-4 w-4 text-red-500"})," ",I?.message||"Checking..."]})})})]}),(0,t.jsxs)(p.Zb,{className:`cursor-pointer transition-all ${D?"ring-2 ring-primary":"hover:border-primary/50"} ${s?"":"opacity-50"}`,onClick:()=>s&&q(!0),children:[(0,t.jsxs)(p.Ol,{className:"pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"h-5 w-5 text-orange-500"}),t.jsx(p.ll,{className:"text-lg",children:"Local Database"})]}),t.jsx(p.SZ,{children:s?"Connect to local PostgreSQL for offline operation":"Only available in desktop app"})]}),t.jsx(p.aY,{children:t.jsx("div",{className:"flex items-center gap-2 text-sm",children:A?.connected?(0,t.jsxs)(t.Fragment,{children:[t.jsx(y.Z,{className:"h-4 w-4 text-green-500"})," Connected (",A.latency,"ms)"]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(v,{className:"h-4 w-4 text-gray-400"})," Not configured"]})})})]})]}),D&&s&&(0,t.jsxs)(p.Zb,{children:[(0,t.jsxs)(p.Ol,{children:[t.jsx(p.ll,{children:"Local PostgreSQL Configuration"}),t.jsx(p.SZ,{children:"Enter your local PostgreSQL server details"})]}),(0,t.jsxs)(p.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{htmlFor:"host",children:"Host"}),t.jsx(m.I,{id:"host",value:u.host,onChange:e=>C({...u,host:e.target.value}),placeholder:"localhost"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{htmlFor:"port",children:"Port"}),t.jsx(m.I,{id:"port",value:u.port,onChange:e=>C({...u,port:e.target.value}),placeholder:"5432"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{htmlFor:"database",children:"Database Name"}),t.jsx(m.I,{id:"database",value:u.database,onChange:e=>C({...u,database:e.target.value}),placeholder:"supermarket_pos"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{htmlFor:"username",children:"Username"}),t.jsx(m.I,{id:"username",value:u.username,onChange:e=>C({...u,username:e.target.value}),placeholder:"postgres"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(x._,{htmlFor:"password",children:"Password"}),t.jsx(m.I,{id:"password",type:"password",value:u.password,onChange:e=>C({...u,password:e.target.value}),placeholder:"••••••••"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[t.jsx(o.z,{onClick:M,disabled:S,variant:"outline",children:S?(0,t.jsxs)(t.Fragment,{children:[t.jsx(N.Z,{className:"h-4 w-4 mr-2 animate-spin"})," Testing..."]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(w.Z,{className:"h-4 w-4 mr-2"})," Test Connection"]})}),t.jsx(o.z,{onClick:O,disabled:Z||!A?.connected,children:Z?(0,t.jsxs)(t.Fragment,{children:[t.jsx(N.Z,{className:"h-4 w-4 mr-2 animate-spin"})," Saving..."]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(k,{className:"h-4 w-4 mr-2"})," Save Configuration"]})})]}),A&&t.jsx("div",{className:`p-3 rounded-lg ${A.connected?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[A.connected?t.jsx(y.Z,{className:"h-4 w-4"}):t.jsx(f.Z,{className:"h-4 w-4"}),A.message]})})]})]}),D&&s&&(0,t.jsxs)(p.Zb,{children:[(0,t.jsxs)(p.Ol,{children:[(0,t.jsxs)(p.ll,{className:"flex items-center gap-2",children:[t.jsx(j,{className:"h-5 w-5"}),"Cloud Sync"]}),t.jsx(p.SZ,{children:"Synchronize local data with the central cloud server"})]}),(0,t.jsxs)(p.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:"Sync Status"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:I?.connected?"Cloud connected":"Cloud offline"})]}),(0,t.jsxs)(o.z,{variant:"outline",onClick:async()=>{h.Am.info("Sync started...");try{await window.electronAPI.triggerSync(),h.Am.success("Sync completed!")}catch{h.Am.error("Sync failed")}},disabled:!I?.connected,children:[t.jsx(w.Z,{className:"h-4 w-4 mr-2"}),"Sync Now"]})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"When online, local changes will automatically sync to the cloud server. Changes from other locations will be pulled down to your local database."})]})]}),(0,t.jsxs)(p.Zb,{children:[t.jsx(p.Ol,{children:t.jsx(p.ll,{children:"Setup Instructions"})}),(0,t.jsxs)(p.aY,{className:"prose dark:prose-invert max-w-none",children:[t.jsx("h4",{children:"Installing PostgreSQL Locally"}),(0,t.jsxs)("ol",{className:"text-sm space-y-2",children:[(0,t.jsxs)("li",{children:["Download PostgreSQL from ",t.jsx("a",{href:"https://www.postgresql.org/download/",target:"_blank",rel:"noopener",className:"text-primary hover:underline",children:"postgresql.org"})]}),t.jsx("li",{children:"Run the installer and set a password for the postgres user"}),(0,t.jsxs)("li",{children:["Create a new database named ",t.jsx("code",{className:"bg-muted px-1 rounded",children:"supermarket_pos"})]}),t.jsx("li",{children:"Enter your connection details above and test the connection"}),t.jsx("li",{children:"Click Save to apply the configuration"})]}),t.jsx("h4",{className:"mt-4",children:"Quick Database Creation (Terminal)"}),t.jsx("pre",{className:"bg-muted p-3 rounded text-xs overflow-x-auto",children:`psql -U postgres
CREATE DATABASE supermarket_pos;
\\q`})]})]})]})})]})})})}},12458:(e,s,a)=>{"use strict";a.d(s,{p:()=>l});var t=a(62901),r=a(84700),n=a(84374);function l({children:e,allowedRoles:s,fallbackUrl:a="/dashboard"}){let{data:l,status:i}=(0,r.useSession)()||{};if((0,n.useRouter)(),"loading"===i)return t.jsx("div",{className:"flex min-h-screen items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})});if("authenticated"===i){let a=l?.user?.role;if(s?.includes?.(a))return t.jsx(t.Fragment,{children:e})}return null}a(24383)},23803:(e,s,a)=>{"use strict";a.d(s,{Ol:()=>i,SZ:()=>c,Zb:()=>l,aY:()=>o,ll:()=>d});var t=a(62901),r=a(24383),n=a(68637);let l=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));l.displayName="Card";let i=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let d=r.forwardRef(({className:e,...s},a)=>t.jsx("h3",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));d.displayName="CardTitle";let c=r.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let o=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,n.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},250:(e,s,a)=>{"use strict";a.d(s,{I:()=>l});var t=a(62901),r=a(24383),n=a(68637);let l=r.forwardRef(({className:e,type:s,...a},r)=>t.jsx("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));l.displayName="Input"},82657:(e,s,a)=>{"use strict";a.d(s,{_:()=>c});var t=a(62901),r=a(24383),n=a(8388),l=a(47279),i=a(68637);let d=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef(({className:e,...s},a)=>t.jsx(n.f,{ref:a,className:(0,i.cn)(d(),e),...s}));c.displayName=n.f.displayName},10333:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(71945).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1845:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(88895).createProxy)(String.raw`/home/ubuntu/supermarket_pos_system/nextjs_space/app/settings/database/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[4372,879,9121,5959,4542,4566],()=>a(52298));module.exports=t})();