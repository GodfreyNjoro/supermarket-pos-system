(()=>{var e={};e.id=9832,e.ids=[9832],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},53161:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>d.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>n,routeModule:()=>x,tree:()=>o}),t(76413),t(32694),t(71363);var r=t(36576),a=t(72007),l=t(21818),d=t.n(l),i=t(88897),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let o=["",{children:["products",{children:["import",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,76413)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/products/import/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,32694)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}],n=["/home/ubuntu/supermarket_pos_system/nextjs_space/app/products/import/page.tsx"],m="/products/import/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/products/import/page",pathname:"/products/import",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},47858:(e,s,t)=>{Promise.resolve().then(t.bind(t,9494))},9494:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(62901),a=t(73735),l=t(12458),d=t(92861),i=t(24383),c=t(75909),o=t(39314),n=t(91464),m=t(68734),p=t(10333),x=t(71945);let u=(0,x.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),h=(0,x.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var g=t(62392),y=t(39350),j=t(59617),b=t(72632);function f(){let{selectedStore:e}=(0,j.o)(),[s,t]=(0,i.useState)("products"),[x,f]=(0,i.useState)(null),[N,k]=(0,i.useState)(!1),[v,w]=(0,i.useState)(null),_=async()=>{if(!x||!e){y.Am.error("Please select a file and store");return}k(!0),w(null);try{let t=new FormData;t.append("file",x),t.append("storeId",e.id),t.append("mode",s);let r=await fetch("/api/products/import",{method:"POST",body:t}),a=await r.json();r.ok?(w(a),"products"===s&&a.created>0?y.Am.success(`${a.created} products imported successfully`):"restock"===s&&a.updated>0&&y.Am.success(`${a.updated} products restocked successfully`),a.errors?.length>0&&y.Am.error(`${a.errors.length} errors occurred`)):y.Am.error(a.error||"Import failed")}catch(e){console.error("Error importing:",e),y.Am.error("Failed to import file")}finally{k(!1)}},P=e=>{let s=b.P6.aoa_to_sheet(["products"===e?["barcode","name","description","price","stock","category","reorderLevel"]:["barcode","quantity"],..."products"===e?[["1234567890123","Sample Product","Product description",100,50,"Groceries",10]]:[["1234567890001",20],["1234567890002",15]]]),t=b.P6.book_new();b.P6.book_append_sheet(t,s,"Template"),b.NC(t,`${e}_template.xlsx`),y.Am.success("Template downloaded")};return r.jsx(a.I,{children:(0,r.jsxs)(l.p,{allowedRoles:["ADMIN"],children:[r.jsx(y.x7,{position:"top-right"}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(d.W,{}),(0,r.jsxs)("main",{className:"mx-auto max-w-3xl px-4 py-8 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)(g.default,{href:"/products",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[r.jsx(c.Z,{className:"h-5 w-5"}),r.jsx("span",{children:"Back to Products"})]})}),(0,r.jsxs)("div",{className:"rounded-xl bg-white p-8 shadow-sm",children:[r.jsx("h1",{className:"mb-6 text-2xl font-bold text-gray-900",children:"Import Products / Restock"}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Import Mode"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("button",{onClick:()=>t("products"),className:`flex-1 rounded-lg border-2 p-4 text-center transition ${"products"===s?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx(o.Z,{className:`mx-auto h-8 w-8 mb-2 ${"products"===s?"text-emerald-600":"text-gray-400"}`}),r.jsx("div",{className:`font-medium ${"products"===s?"text-emerald-700":"text-gray-700"}`,children:"New Products"}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Add new products from Excel"})]}),(0,r.jsxs)("button",{onClick:()=>t("restock"),className:`flex-1 rounded-lg border-2 p-4 text-center transition ${"restock"===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx(n.Z,{className:`mx-auto h-8 w-8 mb-2 ${"restock"===s?"text-blue-600":"text-gray-400"}`}),r.jsx("div",{className:`font-medium ${"restock"===s?"text-blue-700":"text-gray-700"}`,children:"Restock Items"}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Update stock quantities"})]})]})]}),r.jsx("div",{className:"mb-6 rounded-lg bg-gray-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium text-gray-900",children:"Download Template"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Get the Excel template for ","products"===s?"new products":"restocking"]})]}),(0,r.jsxs)("button",{onClick:()=>P(s),className:"flex items-center gap-2 rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300",children:[r.jsx(m.Z,{className:"h-4 w-4"}),"Template"]})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Excel File"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{let s=e.target.files?.[0];s&&(f(s),w(null))},className:"hidden",id:"file-upload"}),(0,r.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[r.jsx(o.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:x?x.name:"Click to select Excel file (.xlsx, .xls)"})]})]})]}),r.jsx("button",{onClick:_,disabled:!x||!e||N,className:"w-full rounded-lg bg-emerald-600 px-4 py-3 font-medium text-white hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:N?(0,r.jsxs)(r.Fragment,{children:[r.jsx(p.Z,{className:"h-5 w-5 animate-spin"})," Processing..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(n.Z,{className:"h-5 w-5"})," Import ","products"===s?"Products":"Restock Data"]})}),v&&(0,r.jsxs)("div",{className:"mt-6 rounded-lg border p-4",children:[r.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Import Results"}),(0,r.jsxs)("div",{className:"space-y-2",children:[void 0!==v.created&&v.created>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(u,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[v.created," products created"]})]}),void 0!==v.updated&&v.updated>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[r.jsx(u,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[v.updated," products restocked"]})]}),v.errors&&v.errors.length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-600 mb-2",children:[r.jsx(h,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[v.errors.length," errors"]})]}),r.jsx("ul",{className:"text-sm text-red-600 bg-red-50 rounded p-3 max-h-40 overflow-y-auto",children:v.errors.map((e,s)=>(0,r.jsxs)("li",{children:["â€¢ ",e]},s))})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 text-sm text-gray-500",children:[r.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),"products"===s?(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[r.jsx("li",{children:"Required columns: barcode, name, price"}),r.jsx("li",{children:"Optional columns: description, stock, category, reorderLevel"}),r.jsx("li",{children:"Categories will be created automatically if they don't exist"})]}):(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[r.jsx("li",{children:"Required columns: barcode, quantity"}),r.jsx("li",{children:"Products must already exist in the system"}),r.jsx("li",{children:"Quantity will be added to existing stock"})]})]})]})]})]})]})})}},12458:(e,s,t)=>{"use strict";t.d(s,{p:()=>d});var r=t(62901),a=t(84700),l=t(84374);function d({children:e,allowedRoles:s,fallbackUrl:t="/dashboard"}){let{data:d,status:i}=(0,a.useSession)()||{};if((0,l.useRouter)(),"loading"===i)return r.jsx("div",{className:"flex min-h-screen items-center justify-center",children:r.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})});if("authenticated"===i){let t=d?.user?.role;if(s?.includes?.(t))return r.jsx(r.Fragment,{children:e})}return null}t(24383)},75909:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},39314:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]])},10333:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},91464:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},76413:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(88895).createProxy)(String.raw`/home/ubuntu/supermarket_pos_system/nextjs_space/app/products/import/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4372,879,9121,3030,4542,4566],()=>t(53161));module.exports=r})();