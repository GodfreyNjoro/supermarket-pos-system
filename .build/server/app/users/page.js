(()=>{var e={};e.id=6240,e.ids=[6240],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14493:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>c}),r(71618),r(32694),r(71363);var a=r(36576),t=r(72007),i=r(21818),n=r.n(i),l=r(88897),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(s,d);let c=["",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,71618)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/users/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,32694)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,71363,23)),"next/dist/client/components/not-found-error"]}],o=["/home/ubuntu/supermarket_pos_system/nextjs_space/app/users/page.tsx"],u="/users/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},89791:(e,s,r)=>{Promise.resolve().then(r.bind(r,72348))},72348:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>G});var a=r(62901),t=r(24383),i=r(84700),n=r(73735),l=r(92861),d=r(23415),c=r(23803),o=r(27878),u=r(250),h=r(82657),p=r(31606),x=r(76556),m=r(72388),j=r(72405),v=r(1940),f=r(56163),g=r(89291),b=r(98106),y=r(45666),w=r(49209),A=r(74132),k="Switch",[N,_]=(0,g.b)(k),[C,S]=N(k),P=t.forwardRef((e,s)=>{let{__scopeSwitch:r,name:i,checked:n,defaultChecked:l,required:d,disabled:c,value:o="on",onCheckedChange:u,...h}=e,[p,x]=t.useState(null),m=(0,f.e)(s,e=>x(e)),j=t.useRef(!1),g=!p||!!p.closest("form"),[y=!1,w]=(0,b.T)({prop:n,defaultProp:l,onChange:u});return(0,a.jsxs)(C,{scope:r,checked:y,disabled:c,children:[(0,a.jsx)(A.WV.button,{type:"button",role:"switch","aria-checked":y,"aria-required":d,"data-state":M(y),"data-disabled":c?"":void 0,disabled:c,value:o,...h,ref:m,onClick:(0,v.M)(e.onClick,e=>{w(e=>!e),g&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),g&&(0,a.jsx)(R,{control:p,bubbles:!j.current,name:i,value:o,checked:y,required:d,disabled:c,style:{transform:"translateX(-100%)"}})]})});P.displayName=k;var E="SwitchThumb",I=t.forwardRef((e,s)=>{let{__scopeSwitch:r,...t}=e,i=S(E,r);return(0,a.jsx)(A.WV.span,{"data-state":M(i.checked),"data-disabled":i.disabled?"":void 0,...t,ref:s})});I.displayName=E;var R=e=>{let{control:s,checked:r,bubbles:i=!0,...n}=e,l=t.useRef(null),d=(0,y.D)(r),c=(0,w.t)(s);return t.useEffect(()=>{let e=l.current,s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(d!==r&&s){let a=new Event("click",{bubbles:i});s.call(e,r),e.dispatchEvent(a)}},[d,r,i]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:l,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function M(e){return e?"checked":"unchecked"}var q=r(68637);let U=t.forwardRef(({className:e,...s},r)=>a.jsx(P,{className:(0,q.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:r,children:a.jsx(I,{className:(0,q.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));U.displayName=P.displayName;var O=r(97718);let T=(0,r(71945).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var z=r(57234),D=r(48119),Z=r(43921);let V=["ADMIN","MANAGER","CASHIER","INVENTORY_CLERK"];function G(){let{data:e}=(0,i.useSession)()||{},[s,r]=(0,t.useState)([]),[v,f]=(0,t.useState)([]),[g,b]=(0,t.useState)(!1),[y,w]=(0,t.useState)(null),[A,k]=(0,t.useState)(null),[N,_]=(0,t.useState)({email:"",name:"",password:"",role:"CASHIER",storeId:"",isActive:!0}),C=e?.user?.role||"",S=C&&(0,D.Fs)(C,"MANAGE_USERS"),P=async()=>{let[e,s]=await Promise.all([fetch("/api/users"),fetch("/api/stores")]);e.ok&&r(await e.json()),s.ok&&f(await s.json())},E=async e=>{e.preventDefault();let s=y?`/api/users/${y.id}`:"/api/users",r=y?"PUT":"POST",a={...N};y&&!N.password&&delete a.password,(await fetch(s,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(Z.Am.success(y?"User updated":"User created"),b(!1),w(null),_({email:"",name:"",password:"",role:"CASHIER",storeId:"",isActive:!0}),P()):Z.Am.error("Failed to save user")},I=e=>{w(e),_({email:e.email,name:e.name||"",password:"",role:e.role,storeId:e.storeId||"",isActive:e.isActive}),b(!0)},R=async e=>{(await fetch(`/api/users/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,isActive:!e.isActive})})).ok&&(Z.Am.success(`User ${e.isActive?"deactivated":"activated"}`),P())},M=e=>{switch(e){case"ADMIN":return"destructive";case"MANAGER":return"default";case"INVENTORY_CLERK":return"secondary";default:return"outline"}};return a.jsx(n.I,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(l.W,{}),a.jsx(d.FE,{children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-xl font-bold",children:"User Management"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage users and their roles"})]}),S&&(0,a.jsxs)(x.Vq,{open:g,onOpenChange:b,children:[a.jsx(x.hg,{asChild:!0,children:(0,a.jsxs)(o.z,{onClick:()=>{w(null),_({email:"",name:"",password:"",role:"CASHIER",storeId:"",isActive:!0})},children:[a.jsx(O.Z,{className:"w-4 h-4 mr-2"})," Add User"]})}),(0,a.jsxs)(x.cZ,{children:[a.jsx(x.fK,{children:a.jsx(x.$N,{children:y?"Edit User":"Add User"})}),(0,a.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(h._,{children:"Email*"}),a.jsx(u.I,{type:"email",value:N.email,onChange:e=>_({...N,email:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx(h._,{children:"Name"}),a.jsx(u.I,{value:N.name,onChange:e=>_({...N,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[a.jsx(h._,{children:y?"New Password (leave blank to keep)":"Password*"}),a.jsx(u.I,{type:"password",value:N.password,onChange:e=>_({...N,password:e.target.value}),required:!y})]}),(0,a.jsxs)("div",{children:[a.jsx(h._,{children:"Role"}),(0,a.jsxs)(m.Ph,{value:N.role,onValueChange:e=>_({...N,role:e}),children:[a.jsx(m.i4,{children:a.jsx(m.ki,{})}),a.jsx(m.Bw,{children:V.map(e=>a.jsx(m.Ql,{value:e,children:e.replace("_"," ")},e))})]})]}),(0,a.jsxs)("div",{children:[a.jsx(h._,{children:"Assigned Store"}),(0,a.jsxs)(m.Ph,{value:N.storeId||"all",onValueChange:e=>_({...N,storeId:"all"===e?"":e}),children:[a.jsx(m.i4,{children:a.jsx(m.ki,{placeholder:"All stores (Admin only)"})}),(0,a.jsxs)(m.Bw,{children:[a.jsx(m.Ql,{value:"all",children:"All Stores"}),v.map(e=>a.jsx(m.Ql,{value:e.id,children:e.name},e.id))]})]})]}),y&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(U,{checked:N.isActive,onCheckedChange:e=>_({...N,isActive:e})}),a.jsx(h._,{children:"Active"})]}),a.jsx(o.z,{type:"submit",className:"w-full",children:y?"Update":"Create"})]})]})]})]}),a.jsx("div",{className:"grid grid-cols-4 gap-4",children:V.map(e=>(0,a.jsxs)(c.Zb,{children:[a.jsx(c.Ol,{className:"pb-2",children:a.jsx(c.ll,{className:"text-sm",children:e.replace("_"," ")})}),a.jsx(c.aY,{children:a.jsx("div",{className:"text-2xl font-bold",children:s.filter(s=>s.role===e).length})})]},e))}),a.jsx(c.Zb,{children:a.jsx(c.aY,{className:"pt-6",children:(0,a.jsxs)(j.iA,{children:[a.jsx(j.xD,{children:(0,a.jsxs)(j.SC,{children:[a.jsx(j.ss,{children:"User"}),a.jsx(j.ss,{children:"Role"}),a.jsx(j.ss,{children:"Store"}),a.jsx(j.ss,{children:"Status"}),a.jsx(j.ss,{children:"Created"}),S&&a.jsx(j.ss,{children:"Actions"})]})}),a.jsx(j.RM,{children:s.map(e=>(0,a.jsxs)(j.SC,{children:[(0,a.jsxs)(j.pj,{children:[a.jsx("div",{className:"font-medium",children:e.name||"No name"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:e.email})]}),(0,a.jsxs)(j.pj,{children:[a.jsx(p.C,{variant:M(e.role),children:e.role.replace("_"," ")}),a.jsx(o.z,{variant:"ghost",size:"sm",className:"ml-2",onClick:()=>k(A===e.id?null:e.id),children:a.jsx(T,{className:"w-3 h-3"})})]}),a.jsx(j.pj,{children:e.store?.name||"All Stores"}),a.jsx(j.pj,{children:a.jsx(p.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})}),a.jsx(j.pj,{children:new Date(e.createdAt).toLocaleDateString()}),S&&a.jsx(j.pj,{children:(0,a.jsxs)("div",{className:"flex gap-1",children:[a.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>I(e),children:a.jsx(z.Z,{className:"w-4 h-4"})}),a.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>R(e),children:e.isActive?"Disable":"Enable"})]})})]},e.id))})]})})}),A&&(0,a.jsxs)(c.Zb,{children:[a.jsx(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"text-lg",children:["Permissions for ",s.find(e=>e.id===A)?.role]})}),a.jsx(c.aY,{children:a.jsx("div",{className:"flex flex-wrap gap-2",children:D.IC[s.find(e=>e.id===A)?.role||""]?.map(e=>a.jsx(p.C,{variant:"outline",children:e.replace(/_/g," ")},e))})})]})]})})]})})}},57234:(e,s,r)=>{"use strict";r.d(s,{Z:()=>a});let a=(0,r(71945).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},71618:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});let a=(0,r(88895).createProxy)(String.raw`/home/ubuntu/supermarket_pos_system/nextjs_space/app/users/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[4372,879,9121,5959,4542,4566,3414],()=>r(14493));module.exports=a})();