(()=>{var e={};e.id=1268,e.ids=[1268],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},88096:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>h,pages:()=>c,routeModule:()=>x,tree:()=>o}),t(45866),t(32694),t(71363);var r=t(36576),n=t(72007),a=t(21818),i=t.n(a),l=t(88897),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["inventory",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,45866)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/inventory/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,32694)),"/home/ubuntu/supermarket_pos_system/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/supermarket_pos_system/nextjs_space/app/inventory/page.tsx"],h="/inventory/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/inventory/page",pathname:"/inventory",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},34389:(e,s,t)=>{Promise.resolve().then(t.bind(t,62536))},62536:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>H});var r=t(62901),n=t(24383),a=t(84700),i=t(73735),l=t(92861),d=t(23415),o=t(23803),c=t(27878),h=t(250),u=t(82657),x=t(31606),j=t(1940),m=t(89291),p=t(34603),f=t(52490),v=t(74132),g=t(1861),y=t(98106),b=t(50430),N="Tabs",[S,C]=(0,m.b)(N,[p.Pc]),k=(0,p.Pc)(),[w,I]=S(N),T=n.forwardRef((e,s)=>{let{__scopeTabs:t,value:n,onValueChange:a,defaultValue:i,orientation:l="horizontal",dir:d,activationMode:o="automatic",...c}=e,h=(0,g.gm)(d),[u,x]=(0,y.T)({prop:n,onChange:a,defaultProp:i});return(0,r.jsx)(w,{scope:t,baseId:(0,b.M)(),value:u,onValueChange:x,orientation:l,dir:h,activationMode:o,children:(0,r.jsx)(v.WV.div,{dir:h,"data-orientation":l,...c,ref:s})})});T.displayName=N;var P="TabsList",A=n.forwardRef((e,s)=>{let{__scopeTabs:t,loop:n=!0,...a}=e,i=I(P,t),l=k(t);return(0,r.jsx)(p.fC,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:n,children:(0,r.jsx)(v.WV.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:s})})});A.displayName=P;var _="TabsTrigger",D=n.forwardRef((e,s)=>{let{__scopeTabs:t,value:n,disabled:a=!1,...i}=e,l=I(_,t),d=k(t),o=E(l.baseId,n),c=O(l.baseId,n),h=n===l.value;return(0,r.jsx)(p.ck,{asChild:!0,...d,focusable:!a,active:h,children:(0,r.jsx)(v.WV.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":c,"data-state":h?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:o,...i,ref:s,onMouseDown:(0,j.M)(e.onMouseDown,e=>{a||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(n)}),onKeyDown:(0,j.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(n)}),onFocus:(0,j.M)(e.onFocus,()=>{let e="manual"!==l.activationMode;h||a||!e||l.onValueChange(n)})})})});D.displayName=_;var R="TabsContent",q=n.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,forceMount:i,children:l,...d}=e,o=I(R,t),c=E(o.baseId,a),h=O(o.baseId,a),u=a===o.value,x=n.useRef(u);return n.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,r.jsx)(f.z,{present:i||u,children:({present:t})=>(0,r.jsx)(v.WV.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":c,hidden:!t,id:h,tabIndex:0,...d,ref:s,style:{...e.style,animationDuration:x.current?"0s":void 0},children:t&&l})})});function E(e,s){return`${e}-trigger-${s}`}function O(e,s){return`${e}-content-${s}`}q.displayName=R;var M=t(68637);let V=n.forwardRef(({className:e,...s},t)=>r.jsx(A,{ref:t,className:(0,M.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));V.displayName=A.displayName;let Z=n.forwardRef(({className:e,...s},t)=>r.jsx(D,{ref:t,className:(0,M.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));Z.displayName=D.displayName;let F=n.forwardRef(({className:e,...s},t)=>r.jsx(q,{ref:t,className:(0,M.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));F.displayName=q.displayName;var z=t(76556),L=t(72388),$=t(72405),Q=t(97718);let B=(0,t(71945).Z)("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);var G=t(21680),K=t(10508),Y=t(48119),W=t(59617),J=t(43921);function H(){let{data:e}=(0,a.useSession)()||{},{selectedStore:s}=(0,W.o)(),[t,j]=(0,n.useState)([]),[m,p]=(0,n.useState)([]),[f,v]=(0,n.useState)([]),[g,y]=(0,n.useState)([]),[b,N]=(0,n.useState)([]),[S,C]=(0,n.useState)(!1),[k,w]=(0,n.useState)(!1),[I,P]=(0,n.useState)({productId:"",type:"CORRECTION",quantityChange:0,reason:""}),[A,_]=(0,n.useState)({fromStoreId:"",toStoreId:"",items:[{barcode:"",productName:"",quantity:1}]}),D=e?.user?.role||"",R=D&&(0,Y.Fs)(D,"ADJUST_INVENTORY"),q=D&&(0,Y.Fs)(D,"TRANSFER_STOCK"),E=async()=>{let e=s?`?storeId=${s.id}`:"",[t,r,n,a,i]=await Promise.all([fetch(`/api/inventory/low-stock${e}`),fetch(`/api/inventory/adjustments${e}`),fetch(`/api/inventory/transfers${e}`),fetch(`/api/products${e}`),fetch("/api/stores")]);t.ok&&j(await t.json()),r.ok&&p(await r.json()),n.ok&&v(await n.json()),a.ok&&y(await a.json()),i.ok&&N(await i.json())},O=async e=>{e.preventDefault(),(await fetch("/api/inventory/adjustments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).ok?(J.Am.success("Stock adjusted"),C(!1),P({productId:"",type:"CORRECTION",quantityChange:0,reason:""}),E()):J.Am.error("Failed to adjust stock")},M=async e=>{e.preventDefault(),(await fetch("/api/inventory/transfers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)})).ok?(J.Am.success("Transfer created"),w(!1),_({fromStoreId:"",toStoreId:"",items:[{barcode:"",productName:"",quantity:1}]}),E()):J.Am.error("Failed to create transfer")},H=async e=>{(await fetch(`/api/inventory/transfers/${e}/complete`,{method:"POST"})).ok?(J.Am.success("Transfer completed"),E()):J.Am.error("Failed to complete transfer")};return r.jsx(i.I,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(l.W,{}),r.jsx(d.FE,{children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-xl font-bold",children:"Inventory Management"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Stock levels, adjustments, and transfers"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[R&&(0,r.jsxs)(z.Vq,{open:S,onOpenChange:C,children:[r.jsx(z.hg,{asChild:!0,children:(0,r.jsxs)(c.z,{variant:"outline",children:[r.jsx(Q.Z,{className:"w-4 h-4 mr-2"})," Adjust Stock"]})}),(0,r.jsxs)(z.cZ,{children:[r.jsx(z.fK,{children:r.jsx(z.$N,{children:"Stock Adjustment"})}),(0,r.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"Product"}),(0,r.jsxs)(L.Ph,{value:I.productId,onValueChange:e=>P({...I,productId:e}),children:[r.jsx(L.i4,{children:r.jsx(L.ki,{placeholder:"Select product"})}),r.jsx(L.Bw,{children:g.map(e=>(0,r.jsxs)(L.Ql,{value:e.id,children:[e.name," (",e.stock,")"]},e.id))})]})]}),(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"Adjustment Type"}),(0,r.jsxs)(L.Ph,{value:I.type,onValueChange:e=>P({...I,type:e}),children:[r.jsx(L.i4,{children:r.jsx(L.ki,{})}),(0,r.jsxs)(L.Bw,{children:[r.jsx(L.Ql,{value:"RESTOCK",children:"Restock"}),r.jsx(L.Ql,{value:"CORRECTION",children:"Correction"}),r.jsx(L.Ql,{value:"DAMAGED",children:"Damaged"}),r.jsx(L.Ql,{value:"EXPIRED",children:"Expired"}),r.jsx(L.Ql,{value:"LOST",children:"Lost/Shrinkage"}),r.jsx(L.Ql,{value:"RETURNED",children:"Returned"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"Quantity Change (+ or -)"}),r.jsx(h.I,{type:"number",value:I.quantityChange,onChange:e=>P({...I,quantityChange:parseInt(e.target.value)||0})})]}),(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"Reason"}),r.jsx(h.I,{value:I.reason,onChange:e=>P({...I,reason:e.target.value})})]}),r.jsx(c.z,{type:"submit",className:"w-full",children:"Submit Adjustment"})]})]})]}),q&&(0,r.jsxs)(z.Vq,{open:k,onOpenChange:w,children:[r.jsx(z.hg,{asChild:!0,children:(0,r.jsxs)(c.z,{children:[r.jsx(B,{className:"w-4 h-4 mr-2"})," Transfer Stock"]})}),(0,r.jsxs)(z.cZ,{children:[r.jsx(z.fK,{children:r.jsx(z.$N,{children:"Stock Transfer"})}),(0,r.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"From Store"}),(0,r.jsxs)(L.Ph,{value:A.fromStoreId,onValueChange:e=>_({...A,fromStoreId:e}),children:[r.jsx(L.i4,{children:r.jsx(L.ki,{placeholder:"Source"})}),r.jsx(L.Bw,{children:b.map(e=>r.jsx(L.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,r.jsxs)("div",{children:[r.jsx(u._,{children:"To Store"}),(0,r.jsxs)(L.Ph,{value:A.toStoreId,onValueChange:e=>_({...A,toStoreId:e}),children:[r.jsx(L.i4,{children:r.jsx(L.ki,{placeholder:"Destination"})}),r.jsx(L.Bw,{children:b.filter(e=>e.id!==A.fromStoreId).map(e=>r.jsx(L.Ql,{value:e.id,children:e.name},e.id))})]})]})]}),A.items.map((e,s)=>(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[r.jsx(h.I,{placeholder:"Barcode",value:e.barcode,onChange:e=>{let t=[...A.items];t[s].barcode=e.target.value;let r=g.find(s=>s.barcode===e.target.value);r&&(t[s].productName=r.name),_({...A,items:t})}}),r.jsx(h.I,{placeholder:"Product",value:e.productName,readOnly:!0}),r.jsx(h.I,{type:"number",min:"1",value:e.quantity,onChange:e=>{let t=[...A.items];t[s].quantity=parseInt(e.target.value)||1,_({...A,items:t})}})]},s)),r.jsx(c.z,{type:"button",variant:"outline",size:"sm",onClick:()=>_({...A,items:[...A.items,{barcode:"",productName:"",quantity:1}]}),children:"+ Add Item"}),r.jsx(c.z,{type:"submit",className:"w-full",children:"Create Transfer"})]})]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)(o.Zb,{children:[(0,r.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(o.ll,{className:"text-sm font-medium",children:"Low Stock Items"}),r.jsx(G.Z,{className:"h-4 w-4 text-orange-500"})]}),r.jsx(o.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:t.length})})]}),(0,r.jsxs)(o.Zb,{children:[(0,r.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(o.ll,{className:"text-sm font-medium",children:"Pending Transfers"}),r.jsx(B,{className:"h-4 w-4 text-blue-500"})]}),r.jsx(o.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:f.filter(e=>"PENDING"===e.status).length})})]}),(0,r.jsxs)(o.Zb,{children:[(0,r.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(o.ll,{className:"text-sm font-medium",children:"Today's Adjustments"}),r.jsx(K.Z,{className:"h-4 w-4 text-green-500"})]}),r.jsx(o.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:m.filter(e=>new Date(e.createdAt).toDateString()===new Date().toDateString()).length})})]})]}),(0,r.jsxs)(T,{defaultValue:"low-stock",children:[(0,r.jsxs)(V,{children:[r.jsx(Z,{value:"low-stock",children:"Low Stock Alerts"}),r.jsx(Z,{value:"adjustments",children:"Stock History"}),r.jsx(Z,{value:"transfers",children:"Transfers"})]}),r.jsx(F,{value:"low-stock",children:r.jsx(o.Zb,{children:r.jsx(o.aY,{className:"pt-6",children:(0,r.jsxs)($.iA,{children:[r.jsx($.xD,{children:(0,r.jsxs)($.SC,{children:[r.jsx($.ss,{children:"Product"}),r.jsx($.ss,{children:"Store"}),r.jsx($.ss,{children:"Current Stock"}),r.jsx($.ss,{children:"Reorder Level"}),r.jsx($.ss,{children:"Status"})]})}),r.jsx($.RM,{children:t.map(e=>(0,r.jsxs)($.SC,{children:[r.jsx($.pj,{className:"font-medium",children:e.name}),r.jsx($.pj,{children:e.storeName||e.store?.name}),r.jsx($.pj,{children:e.stock}),r.jsx($.pj,{children:e.reorderLevel}),r.jsx($.pj,{children:r.jsx(x.C,{variant:0===e.stock?"destructive":"secondary",children:0===e.stock?"Out of Stock":"Low Stock"})})]},e.id))})]})})})}),r.jsx(F,{value:"adjustments",children:r.jsx(o.Zb,{children:r.jsx(o.aY,{className:"pt-6",children:(0,r.jsxs)($.iA,{children:[r.jsx($.xD,{children:(0,r.jsxs)($.SC,{children:[r.jsx($.ss,{children:"Reference"}),r.jsx($.ss,{children:"Product"}),r.jsx($.ss,{children:"Type"}),r.jsx($.ss,{children:"Change"}),r.jsx($.ss,{children:"Before/After"}),r.jsx($.ss,{children:"By"}),r.jsx($.ss,{children:"Date"})]})}),r.jsx($.RM,{children:m.map(e=>(0,r.jsxs)($.SC,{children:[r.jsx($.pj,{className:"font-mono text-xs",children:e.referenceNumber}),r.jsx($.pj,{children:e.product.name}),r.jsx($.pj,{children:r.jsx(x.C,{variant:"outline",children:e.type})}),(0,r.jsxs)($.pj,{className:e.quantityChange>0?"text-green-600":"text-red-600",children:[e.quantityChange>0?"+":"",e.quantityChange]}),(0,r.jsxs)($.pj,{children:[e.quantityBefore," â†’ ",e.quantityAfter]}),r.jsx($.pj,{children:e.user?.name}),r.jsx($.pj,{children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})})})}),r.jsx(F,{value:"transfers",children:r.jsx(o.Zb,{children:r.jsx(o.aY,{className:"pt-6",children:(0,r.jsxs)($.iA,{children:[r.jsx($.xD,{children:(0,r.jsxs)($.SC,{children:[r.jsx($.ss,{children:"Transfer #"}),r.jsx($.ss,{children:"From"}),r.jsx($.ss,{children:"To"}),r.jsx($.ss,{children:"Items"}),r.jsx($.ss,{children:"Status"}),r.jsx($.ss,{children:"Date"}),r.jsx($.ss,{children:"Actions"})]})}),r.jsx($.RM,{children:f.map(e=>(0,r.jsxs)($.SC,{children:[r.jsx($.pj,{className:"font-mono",children:e.transferNumber}),r.jsx($.pj,{children:e.fromStore.name}),r.jsx($.pj,{children:e.toStore.name}),(0,r.jsxs)($.pj,{children:[e.items.length," items"]}),r.jsx($.pj,{children:r.jsx(x.C,{variant:"COMPLETED"===e.status?"default":"PENDING"===e.status?"secondary":"destructive",children:e.status})}),r.jsx($.pj,{children:new Date(e.createdAt).toLocaleDateString()}),r.jsx($.pj,{children:"PENDING"===e.status&&q&&r.jsx(c.z,{size:"sm",onClick:()=>H(e.id),children:"Complete"})})]},e.id))})]})})})})]})]})})]})})}},21680:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},45866:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(88895).createProxy)(String.raw`/home/ubuntu/supermarket_pos_system/nextjs_space/app/inventory/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4372,879,9121,5959,4542,4566,3414],()=>t(88096));module.exports=r})();