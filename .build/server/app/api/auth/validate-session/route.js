"use strict";(()=>{var e={};e.id=838,e.ids=[838],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},84089:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>w,staticGenerationAsyncStorage:()=>p});var r={};t.r(r),t.d(r,{POST:()=>l});var i=t(79182),n=t(72007),a=t(56719),o=t(93442),u=t(86023);async function l(e){try{let{userId:s,sessionToken:t}=await e.json();if(!s||!t)return o.NextResponse.json({valid:!1,error:"Missing credentials"},{status:400});let r=await (0,u.X)(s,t);return o.NextResponse.json({valid:r})}catch(e){return console.error("Session validation error:",e),o.NextResponse.json({valid:!1,error:"Validation failed"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/validate-session/route",pathname:"/api/auth/validate-session",filename:"route",bundlePath:"app/api/auth/validate-session/route"},resolvedPagePath:"/home/ubuntu/supermarket_pos_system/nextjs_space/app/api/auth/validate-session/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:w}=d,h="/api/auth/validate-session/route";function m(){return(0,a.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:p})}},86023:(e,s,t)=>{t.d(s,{L:()=>d,X:()=>c});var r=t(66291),i=t(64617),n=t(35970),a=t(3390),o=t.n(a),u=t(84770),l=t.n(u);let d={adapter:(0,i.N)(n._),providers:[(0,r.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let s=await n._.user.findUnique({where:{email:e.email}});if(!s||!s.isActive||!await o().compare(e.password,s.password))return null;let t=l().randomBytes(32).toString("hex");return await n._.user.update({where:{id:s.id},data:{sessionToken:t,lastLoginAt:new Date}}),{id:s.id,email:s.email,name:s.name,role:s.role,storeId:s.storeId,sessionToken:t}}})],callbacks:{jwt:async({token:e,user:s})=>(s&&(e.id=s.id,e.role=s.role,e.storeId=s.storeId,e.sessionToken=s.sessionToken),e),session:async({session:e,token:s})=>(e?.user&&(e.user.id=s.id,e.user.role=s.role,e.user.storeId=s.storeId,e.user.sessionToken=s.sessionToken),e)},pages:{signIn:"/"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET};async function c(e,s){let t=await n._.user.findUnique({where:{id:e},select:{sessionToken:!0,isActive:!0}});return!!t&&!!t.isActive&&t.sessionToken===s}},35970:(e,s,t)=>{t.d(s,{_:()=>i});let r=require("@prisma/client"),i=globalThis.prisma??new r.PrismaClient},64617:(e,s)=>{s.N=void 0,s.N=function(e){return{createUser:s=>e.user.create({data:s}),getUser:s=>e.user.findUnique({where:{id:s}}),getUserByEmail:s=>e.user.findUnique({where:{email:s}}),async getUserByAccount(s){var t;let r=await e.account.findUnique({where:{provider_providerAccountId:s},select:{user:!0}});return null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null},updateUser:({id:s,...t})=>e.user.update({where:{id:s},data:t}),deleteUser:s=>e.user.delete({where:{id:s}}),linkAccount:s=>e.account.create({data:s}),unlinkAccount:s=>e.account.delete({where:{provider_providerAccountId:s}}),async getSessionAndUser(s){let t=await e.session.findUnique({where:{sessionToken:s},include:{user:!0}});if(!t)return null;let{user:r,...i}=t;return{user:r,session:i}},createSession:s=>e.session.create({data:s}),updateSession:s=>e.session.update({where:{sessionToken:s.sessionToken},data:s}),deleteSession:s=>e.session.delete({where:{sessionToken:s}}),async createVerificationToken(s){let t=await e.verificationToken.create({data:s});return t.id&&delete t.id,t},async useVerificationToken(s){try{let t=await e.verificationToken.delete({where:{identifier_token:s}});return t.id&&delete t.id,t}catch(e){if("P2025"===e.code)return null;throw e}}}}},66291:(e,s)=>{s.Z=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4372,7609,3390],()=>t(84089));module.exports=r})();