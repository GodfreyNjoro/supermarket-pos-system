"use strict";exports.id=4566,exports.ids=[4566],exports.modules={92861:(e,s,a)=>{a.d(s,{W:()=>K});var t=a(62901),r=a(84700),n=a(62392),l=a(84374),d=a(33901),i=a(59183),o=a(83545),c=a(66843),m=a(25715),x=a(15157),f=a(64283),h=a(67935),u=a(23771),p=a(83103),j=a(10508),g=a(25650),N=a(42594),b=a(22857),y=a(5994),v=a(43933),w=a(7259),Z=a(60004),k=a(24383),S=a(67050),C=a(20302),R=a(10780),z=a(6212),O=a(31606);function _(){let{isOnline:e,syncStatus:s}=(0,S.k)();return e&&"idle"===s?(0,t.jsxs)(O.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[t.jsx(C.Z,{className:"w-3 h-3 mr-1"}),"Online"]}):"syncing"===s?(0,t.jsxs)(O.C,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[t.jsx(R.Z,{className:"w-3 h-3 mr-1 animate-spin"}),"Syncing..."]}):e?"error"===s?(0,t.jsxs)(O.C,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[t.jsx(z.Z,{className:"w-3 h-3 mr-1"}),"Sync Error"]}):null:(0,t.jsxs)(O.C,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[t.jsx(z.Z,{className:"w-3 h-3 mr-1"}),"Offline Mode"]})}var A=a(59617),U=a(18370),$=a(48879),I=a(85453),M=a(85330),P=a(68637);let E=$.fC,T=$.xz;$.ZA,$.Uv,$.Tr,$.Ee,k.forwardRef(({className:e,inset:s,children:a,...r},n)=>(0,t.jsxs)($.fF,{ref:n,className:(0,P.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",e),...r,children:[a,t.jsx(Z.Z,{className:"ml-auto h-4 w-4"})]})).displayName=$.fF.displayName,k.forwardRef(({className:e,...s},a)=>t.jsx($.tu,{ref:a,className:(0,P.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})).displayName=$.tu.displayName;let V=k.forwardRef(({className:e,sideOffset:s=4,...a},r)=>t.jsx($.Uv,{children:t.jsx($.VY,{ref:r,sideOffset:s,className:(0,P.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));V.displayName=$.VY.displayName;let W=k.forwardRef(({className:e,inset:s,...a},r)=>t.jsx($.ck,{ref:r,className:(0,P.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",e),...a}));W.displayName=$.ck.displayName,k.forwardRef(({className:e,children:s,checked:a,...r},n)=>(0,t.jsxs)($.oC,{ref:n,className:(0,P.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:a,...r,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx($.wU,{children:t.jsx(I.Z,{className:"h-4 w-4"})})}),s]})).displayName=$.oC.displayName,k.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)($.Rk,{ref:r,className:(0,P.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx($.wU,{children:t.jsx(M.Z,{className:"h-2 w-2 fill-current"})})}),s]})).displayName=$.Rk.displayName;let L=k.forwardRef(({className:e,inset:s,...a},r)=>t.jsx($.__,{ref:r,className:(0,P.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...a}));L.displayName=$.__.displayName;let Y=k.forwardRef(({className:e,...s},a)=>t.jsx($.Z0,{ref:a,className:(0,P.cn)("-mx-1 my-1 h-px bg-muted",e),...s}));Y.displayName=$.Z0.displayName;var D=a(27878);function F(){let{data:e}=(0,r.useSession)()||{},{selectedStore:s,setSelectedStore:a,stores:n,loading:l}=(0,A.o)();if(!e)return null;let d=e?.user?.role,i=e?.user?.storeId,o="ADMIN"===d;return!o&&i?(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-emerald-50 px-3 py-2 text-sm",children:[t.jsx(U.Z,{className:"h-4 w-4 text-emerald-600"}),t.jsx("span",{className:"font-medium text-emerald-900",children:s?.name||"Loading..."})]}):o?(0,t.jsxs)(E,{children:[t.jsx(T,{asChild:!0,children:(0,t.jsxs)(D.z,{variant:"outline",className:"flex items-center gap-2 border-emerald-200 hover:bg-emerald-50",disabled:l,children:[t.jsx(U.Z,{className:"h-4 w-4 text-emerald-600"}),t.jsx("span",{className:"font-medium",children:l?"Loading...":s?.name||"Select Store"}),t.jsx(w.Z,{className:"h-4 w-4 text-gray-500"})]})}),(0,t.jsxs)(V,{align:"end",className:"w-56",children:[t.jsx(L,{children:"Switch Store"}),t.jsx(Y,{}),n.filter(e=>e.isActive).map(e=>(0,t.jsxs)(W,{onClick:()=>a(e),className:s?.id===e.id?"bg-emerald-50 font-medium text-emerald-900":"",children:[t.jsx(U.Z,{className:"mr-2 h-4 w-4"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[t.jsx("span",{children:e.name}),e.address&&t.jsx("span",{className:"text-xs text-gray-500",children:e.address})]})]},e.id)),0===n.length&&t.jsx("div",{className:"px-2 py-4 text-center text-sm text-gray-500",children:"No stores available"})]})]}):null}var B=a(74190),G=a(72388),H=a(79357);function J(){let{currency:e,setCurrency:s}=(0,B.U8)();return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(H.Z,{className:"h-4 w-4 text-gray-500"}),(0,t.jsxs)(G.Ph,{value:e.code,onValueChange:e=>{let a=B.Mf.find(s=>s.code===e);a&&s(a)},children:[t.jsx(G.i4,{className:"w-[120px] h-8 text-sm",children:t.jsx(G.ki,{placeholder:"Currency"})}),t.jsx(G.Bw,{children:B.Mf.map(e=>(0,t.jsxs)(G.Ql,{value:e.code,children:[e.symbol," ",e.code]},e.code))})]})]})}var Q=a(23415);function K(){let{data:e}=(0,r.useSession)()||{},s=(0,l.usePathname)(),[a,S]=(0,k.useState)(!1),[C,R]=(0,k.useState)(s?.startsWith("/inventory")||s?.startsWith("/suppliers")),[z,O]=(0,k.useState)(!1),{isPinned:A,setIsPinned:U}=(0,Q.Ap)(),$=A||z,I=e?.user?.role,M="ADMIN"===I,P="CASHIER"===I,E="ADMIN"===I||"MANAGER"===I,T=[{name:"Dashboard",href:"/dashboard",icon:d.Z,show:!0},{name:"POS",href:"/pos",icon:i.Z,show:!0},{name:"Products",href:"/products",icon:o.Z,show:E},{name:"Customers",href:"/customers",icon:c.Z,show:E},{name:"Sales",href:"/sales",icon:m.Z,show:!0},{name:"Reports",href:"/reports",icon:d.Z,show:E},{name:"Returns",href:"/returns",icon:x.Z,show:E},{name:"Users",href:"/users",icon:f.Z,show:M},{name:"Settings",href:"/settings/database",icon:h.Z,show:M}],V=[{name:"Stock Management",href:"/inventory",icon:u.Z},{name:"Suppliers",href:"/suppliers",icon:p.Z},{name:"History",href:"/inventory/history",icon:j.Z}],W=T.filter(e=>e.show);return P?t.jsx("nav",{className:"sticky top-0 z-50 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[t.jsx("div",{className:"flex items-center",children:(0,t.jsxs)(n.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[t.jsx(i.Z,{className:"h-8 w-8 text-emerald-600"}),t.jsx("span",{className:"text-xl font-bold text-gray-900",children:"SuperPOS"})]})}),t.jsx("div",{className:"hidden md:flex items-baseline space-x-4",children:[{name:"Dashboard",href:"/dashboard",icon:d.Z},{name:"POS",href:"/pos",icon:i.Z},{name:"Sales",href:"/sales",icon:m.Z}].map(e=>{let a=s===e.href,r=e.icon;return(0,t.jsxs)(n.default,{href:e.href,className:`flex items-center space-x-2 rounded-md px-3 py-2 text-sm font-medium transition-colors ${a?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:[t.jsx(r,{className:"h-5 w-5"}),t.jsx("span",{children:e.name})]},e.name)})}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx(_,{}),t.jsx(J,{}),t.jsx(F,{}),t.jsx("span",{className:"hidden md:block text-sm font-medium text-gray-600",children:e?.user?.name}),(0,t.jsxs)("button",{onClick:()=>(0,r.signOut)({callbackUrl:"/"}),className:"flex items-center space-x-2 rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200",children:[t.jsx(g.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})]})})}):(0,t.jsxs)(t.Fragment,{children:[t.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 h-16 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"flex h-full items-center justify-between px-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("button",{onClick:()=>S(!a),className:"mr-4 lg:hidden",children:a?t.jsx(N.Z,{className:"h-6 w-6"}):t.jsx(b.Z,{className:"h-6 w-6"})}),(0,t.jsxs)(n.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[t.jsx(i.Z,{className:"h-8 w-8 text-emerald-600"}),t.jsx("span",{className:"text-xl font-bold text-gray-900",children:"SuperPOS"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx(_,{}),t.jsx(J,{}),t.jsx(F,{}),(0,t.jsxs)("div",{className:"hidden md:flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600",children:e?.user?.name}),t.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-700",children:I})]}),(0,t.jsxs)("button",{onClick:()=>(0,r.signOut)({callbackUrl:"/"}),className:"flex items-center space-x-2 rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200",children:[t.jsx(g.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})]})}),(0,t.jsxs)("aside",{onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),className:`fixed top-16 left-0 z-40 h-[calc(100vh-4rem)] border-r border-gray-200 bg-white transition-all duration-300 ${a?"translate-x-0 w-64":"-translate-x-full lg:translate-x-0"} ${$?"w-64":"w-16"}`,children:[t.jsx("div",{className:"hidden lg:flex items-center justify-end px-3 pt-3",children:t.jsx("button",{onClick:()=>{U(!A)},className:"p-1.5 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-colors",title:A?"Unpin sidebar":"Pin sidebar",children:A?t.jsx(y.Z,{className:"h-4 w-4"}):t.jsx(v.Z,{className:"h-4 w-4"})})}),t.jsx("nav",{className:`h-full overflow-y-auto px-3 ${$?"py-2":"py-4"}`,children:(0,t.jsxs)("ul",{className:"space-y-1",children:[W.map(e=>{let a=s===e.href,r=e.icon;return t.jsx("li",{children:(0,t.jsxs)(n.default,{href:e.href,onClick:()=>S(!1),title:$?void 0:e.name,className:`flex items-center rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${a?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"} ${$?"space-x-3":"justify-center"}`,children:[t.jsx(r,{className:"h-5 w-5 flex-shrink-0"}),$&&t.jsx("span",{children:e.name})]})},e.name)}),(E||"INVENTORY_CLERK"===I)&&t.jsx("li",{children:$?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>R(!C),className:`flex w-full items-center justify-between rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${s?.startsWith("/inventory")||s?.startsWith("/suppliers")?"bg-emerald-50 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[t.jsx(u.Z,{className:"h-5 w-5"}),t.jsx("span",{children:"Inventory"})]}),C?t.jsx(w.Z,{className:"h-4 w-4"}):t.jsx(Z.Z,{className:"h-4 w-4"})]}),C&&t.jsx("ul",{className:"mt-1 ml-4 space-y-1 border-l border-gray-200 pl-4",children:V.map(e=>{let a=s===e.href,r=e.icon;return t.jsx("li",{children:(0,t.jsxs)(n.default,{href:e.href,onClick:()=>S(!1),className:`flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors ${a?"bg-emerald-100 text-emerald-700":"text-gray-600 hover:bg-gray-100"}`,children:[t.jsx(r,{className:"h-4 w-4"}),t.jsx("span",{children:e.name})]})},e.name)})})]}):t.jsx(n.default,{href:"/inventory",title:"Inventory",className:`flex items-center justify-center rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${s?.startsWith("/inventory")||s?.startsWith("/suppliers")?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:t.jsx(u.Z,{className:"h-5 w-5"})})})]})})]}),a&&t.jsx("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:()=>S(!1)})]})}},73735:(e,s,a)=>{a.d(s,{I:()=>i});var t=a(62901),r=a(84700),n=a(84374),l=a(24383),d=a(60437);function i({children:e}){let{data:s,status:a}=(0,r.useSession)()||{};(0,n.useRouter)();let i=(0,l.useRef)(!1);return((0,l.useCallback)(async()=>{if(!s?.user||i.current)return;let e=s.user;if(e.id&&e.sessionToken)try{let s=await fetch("/api/auth/validate-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,sessionToken:e.sessionToken})});(await s.json()).valid||((0,d.Am)({title:"Session Expired",description:"You have been logged out because another session was started.",variant:"destructive"}),await (0,r.signOut)({callbackUrl:"/"})),i.current=!0}catch(e){console.error("Session validation error:",e)}},[s]),"loading"===a)?t.jsx("div",{className:"flex min-h-screen items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})}):"authenticated"===a?t.jsx(t.Fragment,{children:e}):null}},31606:(e,s,a)=>{a.d(s,{C:()=>d});var t=a(62901);a(24383);var r=a(47279),n=a(68637);let l=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:s,...a}){return t.jsx("div",{className:(0,n.cn)(l({variant:s}),e),...a})}},72388:(e,s,a)=>{a.d(s,{Bw:()=>u,Ph:()=>c,Ql:()=>p,i4:()=>x,ki:()=>m});var t=a(62901),r=a(24383),n=a(76960),l=a(7259),d=a(26026),i=a(85453),o=a(68637);let c=n.fC;n.ZA;let m=n.B4,x=r.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(n.xz,{ref:r,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,t.jsx(n.JO,{asChild:!0,children:t.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=n.xz.displayName;let f=r.forwardRef(({className:e,...s},a)=>t.jsx(n.u_,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(d.Z,{className:"h-4 w-4"})}));f.displayName=n.u_.displayName;let h=r.forwardRef(({className:e,...s},a)=>t.jsx(n.$G,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(l.Z,{className:"h-4 w-4"})}));h.displayName=n.$G.displayName;let u=r.forwardRef(({className:e,children:s,position:a="popper",...r},l)=>t.jsx(n.h_,{children:(0,t.jsxs)(n.VY,{ref:l,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...r,children:[t.jsx(f,{}),t.jsx(n.l_,{className:(0,o.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(h,{})]})}));u.displayName=n.VY.displayName,r.forwardRef(({className:e,...s},a)=>t.jsx(n.__,{ref:a,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=n.__.displayName;let p=r.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(n.ck,{ref:r,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(n.wU,{children:t.jsx(i.Z,{className:"h-4 w-4"})})}),t.jsx(n.eT,{children:s})]}));p.displayName=n.ck.displayName,r.forwardRef(({className:e,...s},a)=>t.jsx(n.Z0,{ref:a,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=n.Z0.displayName},67050:(e,s,a)=>{a.d(s,{k:()=>r});var t=a(24383);function r(){let[e,s]=(0,t.useState)(!0),[a,r]=(0,t.useState)("idle");return{isOnline:e,syncStatus:a,setSyncStatus:r}}}};