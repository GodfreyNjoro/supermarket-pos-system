(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{85619:function(e,s,t){Promise.resolve().then(t.bind(t,99628))},99628:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return S}});var l=t(15444),a=t(46271),n=t(11117),i=t(3763),r=t(95777),d=t(89300),c=t(48803),o=t(57243),x=t(5468),m=t(96516),h=t(86354),u=t(90817),j=t(16014),f=t(74272),p=t(89966),y=t(71639),g=t(83648),b=t(64670),N=t(16629),v=t(3857);let w=["#10b981","#60A5FA","#F59E0B","#EF4444"];function S(){let{formatPrice:e}=(0,v.U8)(),[s,t]=(0,d.useState)(null),[S,k]=(0,d.useState)("month"),[A,B]=(0,d.useState)(!0);(0,d.useEffect)(()=>{P()},[S]);let P=async()=>{try{B(!0);let e=await fetch(`/api/sales/stats?period=${S}`),s=await e.json();t(s)}catch(e){console.error("Error fetching stats:",e)}finally{B(!1)}};return(0,l.jsx)(a.I,{children:(0,l.jsx)(n.p,{allowedRoles:["ADMIN"],children:(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(i.W,{}),(0,l.jsx)(r.FE,{children:(0,l.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Reports"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"Analyze business performance"})]}),(0,l.jsx)("div",{className:"mb-6 flex space-x-2",children:["today","week","month"].map?.(e=>l.jsxs("button",{onClick:()=>k(e),className:`rounded-lg px-4 py-2 text-sm font-medium transition-colors ${S===e?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[e?.charAt?.(0)?.toUpperCase?.()??"",e?.slice?.(1)??""]},e))??null}),A?(0,l.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,l.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-8 grid gap-6 sm:grid-cols-3",children:[(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:e(s?.totalSales??0)})]}),(0,l.jsx)("div",{className:"rounded-full bg-emerald-100 p-3",children:(0,l.jsx)(g.Z,{className:"h-6 w-6 text-emerald-600"})})]})}),(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:s?.totalTransactions??0})]}),(0,l.jsx)("div",{className:"rounded-full bg-blue-100 p-3",children:(0,l.jsx)(b.Z,{className:"h-6 w-6 text-blue-600"})})]})}),(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Transaction"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:e(s?.totalTransactions&&s?.totalSales?s.totalSales/s.totalTransactions:0)})]}),(0,l.jsx)("div",{className:"rounded-full bg-purple-100 p-3",children:(0,l.jsx)(N.Z,{className:"h-6 w-6 text-purple-600"})})]})})]}),s?.salesByDay&&s.salesByDay?.length>0&&(0,l.jsxs)("div",{className:"mb-8 rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Sales Trend"}),(0,l.jsx)(c.h,{width:"100%",height:300,children:(0,l.jsxs)(o.v,{data:s.salesByDay,children:[(0,l.jsx)(x.K,{dataKey:"date",tickLine:!1,tick:{fontSize:10},label:{value:"Date",position:"insideBottom",offset:-15,style:{textAnchor:"middle",fontSize:11}}}),(0,l.jsx)(m.B,{tickLine:!1,tick:{fontSize:10},label:{value:"Revenue ($)",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:11}}}),(0,l.jsx)(h.u,{wrapperStyle:{fontSize:11}}),(0,l.jsx)(u.D,{verticalAlign:"top",wrapperStyle:{fontSize:11}}),(0,l.jsx)(j.$,{dataKey:"total",fill:"#10b981",name:"Sales"})]})})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[s?.salesByPaymentMethod&&s.salesByPaymentMethod?.length>0&&(0,l.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Payment Methods"}),(0,l.jsx)(c.h,{width:"100%",height:250,children:(0,l.jsxs)(f.u,{children:[(0,l.jsx)(p.b,{data:s.salesByPaymentMethod?.map?.(e=>({name:e?.paymentMethod,value:e?._sum?.total}))??[],cx:"50%",cy:"50%",labelLine:!1,label:e=>e?.name,outerRadius:80,fill:"#8884d8",dataKey:"value",children:s.salesByPaymentMethod?.map?.((e,s)=>l.jsx(y.b,{fill:w[s%w.length]},`cell-${s}`))??null}),(0,l.jsx)(h.u,{wrapperStyle:{fontSize:11}}),(0,l.jsx)(u.D,{verticalAlign:"top",wrapperStyle:{fontSize:11}})]})})]}),(0,l.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Top Products"}),(0,l.jsx)("div",{className:"space-y-3",children:s?.topProducts&&s.topProducts?.length>0?s.topProducts?.slice?.(0,5)?.map?.((s,t)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-emerald-100 text-sm font-bold text-emerald-600",children:t+1}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:s?.product?.name}),l.jsxs("p",{className:"text-sm text-gray-500",children:[s?.quantity??0," sold"]})]})]}),l.jsx("p",{className:"font-semibold text-gray-900",children:e(s?.revenue??0)})]},s?.product?.id))??null:(0,l.jsx)("p",{className:"text-center text-gray-500",children:"No data available"})})]})]})]})]})})]})})})}},11117:function(e,s,t){"use strict";t.d(s,{p:function(){return r}});var l=t(15444),a=t(75762),n=t(79047),i=t(89300);function r({children:e,allowedRoles:s,fallbackUrl:t="/dashboard"}){let{data:r,status:d}=(0,a.useSession)()||{},c=(0,n.useRouter)();if((0,i.useEffect)(()=>{if("authenticated"===d&&r?.user){let e=r.user?.role;s?.includes?.(e)||c.replace(t)}},[d,r,s,t,c]),"loading"===d)return(0,l.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,l.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})});if("authenticated"===d){let t=r?.user?.role;if(s?.includes?.(t))return(0,l.jsx)(l.Fragment,{children:e})}return null}}},function(e){e.O(0,[676,258,535,331,752,608,386,156,744],function(){return e(e.s=85619)}),_N_E=e.O()}]);