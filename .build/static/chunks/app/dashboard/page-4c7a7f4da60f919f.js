(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{68165:function(e,s,t){Promise.resolve().then(t.bind(t,57556))},57556:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var l=t(15444),a=t(46271),d=t(3763),r=t(95777),i=t(89300),c=t(83648),n=t(54907),x=t(64670),o=t(70362),m=t(16629),h=t(41084),u=t(48803),j=t(57243),p=t(5468),f=t(96516),g=t(86354),N=t(90817),y=t(16014),b=t(82534),v=t(3857);function w(){let{selectedStore:e}=(0,b.o)(),{formatPrice:s}=(0,v.U8)(),[t,w]=(0,i.useState)(null),[S,k]=(0,i.useState)("today"),[A,P]=(0,i.useState)(!0);(0,i.useEffect)(()=>{e&&T()},[S,e]);let T=async()=>{try{if(!e)return;P(!0);let s=await fetch(`/api/sales/stats?period=${S}&storeId=${e.id}`),t=await s.json();w(t)}catch(e){console.error("Error fetching stats:",e)}finally{P(!1)}};return(0,l.jsx)(a.I,{children:(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.W,{}),(0,l.jsx)(r.FE,{children:(0,l.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"Monitor your supermarket performance"})]}),(0,l.jsx)("div",{className:"mb-6 flex space-x-2",children:["today","week","month"].map?.(e=>l.jsxs("button",{onClick:()=>k(e),className:`rounded-lg px-4 py-2 text-sm font-medium transition-colors ${S===e?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[e?.charAt?.(0)?.toUpperCase?.()??"",e?.slice?.(1)??""]},e))??null}),A?(0,l.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,l.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Sales"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:s(t?.totalSales??0)})]}),(0,l.jsx)("div",{className:"rounded-full bg-emerald-100 p-3",children:(0,l.jsx)(c.Z,{className:"h-6 w-6 text-emerald-600"})})]})}),(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:t?.totalTransactions??0})]}),(0,l.jsx)("div",{className:"rounded-full bg-blue-100 p-3",children:(0,l.jsx)(n.Z,{className:"h-6 w-6 text-blue-600"})})]})}),(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Transaction"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:s(t?.totalTransactions&&t?.totalSales?t.totalSales/t.totalTransactions:0)})]}),(0,l.jsx)("div",{className:"rounded-full bg-purple-100 p-3",children:(0,l.jsx)(x.Z,{className:"h-6 w-6 text-purple-600"})})]})}),(0,l.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Low Stock Items"}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:t?.lowStockProducts?.length??0})]}),(0,l.jsx)("div",{className:"rounded-full bg-red-100 p-3",children:(0,l.jsx)(o.Z,{className:"h-6 w-6 text-red-600"})})]})})]}),t?.salesByDay&&t.salesByDay?.length>0&&(0,l.jsxs)("div",{className:"mb-8 rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Sales Trend"}),(0,l.jsx)(u.h,{width:"100%",height:300,children:(0,l.jsxs)(j.v,{data:t.salesByDay,children:[(0,l.jsx)(p.K,{dataKey:"date",tickLine:!1,tick:{fontSize:10},label:{value:"Date",position:"insideBottom",offset:-15,style:{textAnchor:"middle",fontSize:11}}}),(0,l.jsx)(f.B,{tickLine:!1,tick:{fontSize:10},label:{value:"Sales ($)",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:11}}}),(0,l.jsx)(g.u,{wrapperStyle:{fontSize:11}}),(0,l.jsx)(N.D,{verticalAlign:"top",wrapperStyle:{fontSize:11}}),(0,l.jsx)(y.$,{dataKey:"total",fill:"#10b981",name:"Sales"})]})})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Top Products"}),(0,l.jsx)(m.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,l.jsx)("div",{className:"space-y-3",children:t?.topProducts&&t.topProducts?.length>0?t.topProducts?.slice?.(0,5)?.map?.((e,t)=>l.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-gray-50 p-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-emerald-100 text-sm font-bold text-emerald-600",children:t+1}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:e?.product?.name}),l.jsxs("p",{className:"text-sm text-gray-500",children:[e?.quantity??0," sold"]})]})]}),l.jsx("div",{className:"text-right",children:l.jsx("p",{className:"font-semibold text-gray-900",children:s(e?.revenue??0)})})]},e?.product?.id))??null:(0,l.jsx)("p",{className:"text-center text-gray-500",children:"No data available"})})]}),(0,l.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Low Stock Alert"}),(0,l.jsx)(o.Z,{className:"h-5 w-5 text-red-500"})]}),(0,l.jsx)("div",{className:"space-y-3",children:t?.lowStockProducts&&t.lowStockProducts?.length>0?t.lowStockProducts?.slice?.(0,5)?.map?.(e=>l.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-red-50 p-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:e?.name}),l.jsx("p",{className:"text-sm text-gray-500",children:e?.category?.name})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-semibold text-red-600",children:[e?.stock??0," left"]}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Min: ",e?.reorderLevel??0]})]})]},e?.id))??null:(0,l.jsx)("p",{className:"text-center text-gray-500",children:"All products well stocked"})}),(0,l.jsx)(h.default,{href:"/products",className:"mt-4 block text-center text-sm font-medium text-emerald-600 hover:text-emerald-700",children:"View All Products"})]})]})]})]})})]})})}},70362:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(42154).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}},function(e){e.O(0,[676,258,535,331,608,386,156,744],function(){return e(e.s=68165)}),_N_E=e.O()}]);