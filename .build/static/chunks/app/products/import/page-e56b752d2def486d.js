(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[832],{48463:function(){},26503:function(){},87997:function(e,s,t){Promise.resolve().then(t.bind(t,12575))},12575:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var r=t(15444),a=t(46271),l=t(11117),d=t(3763),c=t(89300),i=t(98155),n=t(7433),o=t(4805),m=t(26584),x=t(1946),u=t(66124),h=t(77694),p=t(41084),g=t(64611),j=t(82534),b=t(89634);function f(){let{selectedStore:e}=(0,j.o)(),[s,t]=(0,c.useState)("products"),[f,N]=(0,c.useState)(null),[y,v]=(0,c.useState)(!1),[w,k]=(0,c.useState)(null),P=async()=>{if(!f||!e){g.Am.error("Please select a file and store");return}v(!0),k(null);try{let t=new FormData;t.append("file",f),t.append("storeId",e.id),t.append("mode",s);let r=await fetch("/api/products/import",{method:"POST",body:t}),a=await r.json();r.ok?(k(a),"products"===s&&a.created>0?g.Am.success(`${a.created} products imported successfully`):"restock"===s&&a.updated>0&&g.Am.success(`${a.updated} products restocked successfully`),a.errors?.length>0&&g.Am.error(`${a.errors.length} errors occurred`)):g.Am.error(a.error||"Import failed")}catch(e){console.error("Error importing:",e),g.Am.error("Failed to import file")}finally{v(!1)}},_=e=>{let s=b.P6.aoa_to_sheet(["products"===e?["barcode","name","description","price","stock","category","reorderLevel"]:["barcode","quantity"],..."products"===e?[["1234567890123","Sample Product","Product description",100,50,"Groceries",10]]:[["1234567890001",20],["1234567890002",15]]]),t=b.P6.book_new();b.P6.book_append_sheet(t,s,"Template"),b.NC(t,`${e}_template.xlsx`),g.Am.success("Template downloaded")};return(0,r.jsx)(a.I,{children:(0,r.jsxs)(l.p,{allowedRoles:["ADMIN"],children:[(0,r.jsx)(g.x7,{position:"top-right"}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.W,{}),(0,r.jsxs)("main",{className:"mx-auto max-w-3xl px-4 py-8 sm:px-6 lg:px-8",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)(p.default,{href:"/products",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[(0,r.jsx)(i.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Back to Products"})]})}),(0,r.jsxs)("div",{className:"rounded-xl bg-white p-8 shadow-sm",children:[(0,r.jsx)("h1",{className:"mb-6 text-2xl font-bold text-gray-900",children:"Import Products / Restock"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Import Mode"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("button",{onClick:()=>t("products"),className:`flex-1 rounded-lg border-2 p-4 text-center transition ${"products"===s?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,r.jsx)(n.Z,{className:`mx-auto h-8 w-8 mb-2 ${"products"===s?"text-emerald-600":"text-gray-400"}`}),(0,r.jsx)("div",{className:`font-medium ${"products"===s?"text-emerald-700":"text-gray-700"}`,children:"New Products"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Add new products from Excel"})]}),(0,r.jsxs)("button",{onClick:()=>t("restock"),className:`flex-1 rounded-lg border-2 p-4 text-center transition ${"restock"===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,r.jsx)(o.Z,{className:`mx-auto h-8 w-8 mb-2 ${"restock"===s?"text-blue-600":"text-gray-400"}`}),(0,r.jsx)("div",{className:`font-medium ${"restock"===s?"text-blue-700":"text-gray-700"}`,children:"Restock Items"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Update stock quantities"})]})]})]}),(0,r.jsx)("div",{className:"mb-6 rounded-lg bg-gray-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:"Download Template"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Get the Excel template for ","products"===s?"new products":"restocking"]})]}),(0,r.jsxs)("button",{onClick:()=>_(s),className:"flex items-center gap-2 rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),"Template"]})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Excel File"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,r.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{let s=e.target.files?.[0];s&&(N(s),k(null))},className:"hidden",id:"file-upload"}),(0,r.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,r.jsx)(n.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:f?f.name:"Click to select Excel file (.xlsx, .xls)"})]})]})]}),(0,r.jsx)("button",{onClick:P,disabled:!f||!e||y,className:"w-full rounded-lg bg-emerald-600 px-4 py-3 font-medium text-white hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{className:"h-5 w-5 animate-spin"})," Processing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"h-5 w-5"})," Import ","products"===s?"Products":"Restock Data"]})}),w&&(0,r.jsxs)("div",{className:"mt-6 rounded-lg border p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Import Results"}),(0,r.jsxs)("div",{className:"space-y-2",children:[void 0!==w.created&&w.created>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[w.created," products created"]})]}),void 0!==w.updated&&w.updated>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[w.updated," products restocked"]})]}),w.errors&&w.errors.length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-600 mb-2",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[w.errors.length," errors"]})]}),(0,r.jsx)("ul",{className:"text-sm text-red-600 bg-red-50 rounded p-3 max-h-40 overflow-y-auto",children:w.errors.map((e,s)=>(0,r.jsxs)("li",{children:["â€¢ ",e]},s))})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 text-sm text-gray-500",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),"products"===s?(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:"Required columns: barcode, name, price"}),(0,r.jsx)("li",{children:"Optional columns: description, stock, category, reorderLevel"}),(0,r.jsx)("li",{children:"Categories will be created automatically if they don't exist"})]}):(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:"Required columns: barcode, quantity"}),(0,r.jsx)("li",{children:"Products must already exist in the system"}),(0,r.jsx)("li",{children:"Quantity will be added to existing stock"})]})]})]})]})]})]})})}},11117:function(e,s,t){"use strict";t.d(s,{p:function(){return c}});var r=t(15444),a=t(75762),l=t(79047),d=t(89300);function c({children:e,allowedRoles:s,fallbackUrl:t="/dashboard"}){let{data:c,status:i}=(0,a.useSession)()||{},n=(0,l.useRouter)();if((0,d.useEffect)(()=>{if("authenticated"===i&&c?.user){let e=c.user?.role;s?.includes?.(e)||n.replace(t)}},[i,c,s,t,n]),"loading"===i)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})});if("authenticated"===i){let t=c?.user?.role;if(s?.includes?.(t))return(0,r.jsx)(r.Fragment,{children:e})}return null}}},function(e){e.O(0,[710,676,258,535,991,608,386,156,744],function(){return e(e.s=87997)}),_N_E=e.O()}]);