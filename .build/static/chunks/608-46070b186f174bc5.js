"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[608],{3763:function(e,t,s){s.d(t,{W:function(){return Q}});var a=s(15444),r=s(75762),n=s(41084),i=s(79047),o=s(26378),l=s(54907),d=s(16629),c=s(64624),m=s(41509),u=s(6175),f=s(85038),x=s(6488),h=s(68293),p=s(99201),g=s(81410),y=s(97480),b=s(33485),j=s(78503),v=s(31860),N=s(66704),w=s(63751),S=s(23572),Z=s(89300),k=s(32226),E=s(9621),I=s(81471),C=s(4460),R=s(61335);function T(){let{isOnline:e,syncStatus:t}=(0,k.k)();return e&&"idle"===t?(0,a.jsxs)(R.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[(0,a.jsx)(E.Z,{className:"w-3 h-3 mr-1"}),"Online"]}):"syncing"===t?(0,a.jsxs)(R.C,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[(0,a.jsx)(I.Z,{className:"w-3 h-3 mr-1 animate-spin"}),"Syncing..."]}):e?"error"===t?(0,a.jsxs)(R.C,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[(0,a.jsx)(C.Z,{className:"w-3 h-3 mr-1"}),"Sync Error"]}):null:(0,a.jsxs)(R.C,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[(0,a.jsx)(C.Z,{className:"w-3 h-3 mr-1"}),"Offline Mode"]})}var A=s(82534),_=s(15502),O=s(78658),P=s(77248),z=s(70966),D=s(65522);let U=O.fC,M=O.xz;O.ZA,O.Uv,O.Tr,O.Ee,Z.forwardRef(({className:e,inset:t,children:s,...r},n)=>(0,a.jsxs)(O.fF,{ref:n,className:(0,D.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[s,(0,a.jsx)(S.Z,{className:"ml-auto h-4 w-4"})]})).displayName=O.fF.displayName,Z.forwardRef(({className:e,...t},s)=>(0,a.jsx)(O.tu,{ref:s,className:(0,D.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})).displayName=O.tu.displayName;let $=Z.forwardRef(({className:e,sideOffset:t=4,...s},r)=>(0,a.jsx)(O.Uv,{children:(0,a.jsx)(O.VY,{ref:r,sideOffset:t,className:(0,D.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));$.displayName=O.VY.displayName;let L=Z.forwardRef(({className:e,inset:t,...s},r)=>(0,a.jsx)(O.ck,{ref:r,className:(0,D.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...s}));L.displayName=O.ck.displayName,Z.forwardRef(({className:e,children:t,checked:s,...r},n)=>(0,a.jsxs)(O.oC,{ref:n,className:(0,D.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:s,...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(O.wU,{children:(0,a.jsx)(P.Z,{className:"h-4 w-4"})})}),t]})).displayName=O.oC.displayName,Z.forwardRef(({className:e,children:t,...s},r)=>(0,a.jsxs)(O.Rk,{ref:r,className:(0,D.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(O.wU,{children:(0,a.jsx)(z.Z,{className:"h-2 w-2 fill-current"})})}),t]})).displayName=O.Rk.displayName;let F=Z.forwardRef(({className:e,inset:t,...s},r)=>(0,a.jsx)(O.__,{ref:r,className:(0,D.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...s}));F.displayName=O.__.displayName;let V=Z.forwardRef(({className:e,...t},s)=>(0,a.jsx)(O.Z0,{ref:s,className:(0,D.cn)("-mx-1 my-1 h-px bg-muted",e),...t}));V.displayName=O.Z0.displayName;var W=s(2422);function G(){let{data:e}=(0,r.useSession)()||{},{selectedStore:t,setSelectedStore:s,stores:n,loading:i}=(0,A.o)();if(!e)return null;let o=e?.user?.role,l=e?.user?.storeId,d="ADMIN"===o;return!d&&l?(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-emerald-50 px-3 py-2 text-sm",children:[(0,a.jsx)(_.Z,{className:"h-4 w-4 text-emerald-600"}),(0,a.jsx)("span",{className:"font-medium text-emerald-900",children:t?.name||"Loading..."})]}):d?(0,a.jsxs)(U,{children:[(0,a.jsx)(M,{asChild:!0,children:(0,a.jsxs)(W.z,{variant:"outline",className:"flex items-center gap-2 border-emerald-200 hover:bg-emerald-50",disabled:i,children:[(0,a.jsx)(_.Z,{className:"h-4 w-4 text-emerald-600"}),(0,a.jsx)("span",{className:"font-medium",children:i?"Loading...":t?.name||"Select Store"}),(0,a.jsx)(w.Z,{className:"h-4 w-4 text-gray-500"})]})}),(0,a.jsxs)($,{align:"end",className:"w-56",children:[(0,a.jsx)(F,{children:"Switch Store"}),(0,a.jsx)(V,{}),n.filter(e=>e.isActive).map(e=>(0,a.jsxs)(L,{onClick:()=>s(e),className:t?.id===e.id?"bg-emerald-50 font-medium text-emerald-900":"",children:[(0,a.jsx)(_.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:e.name}),e.address&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.address})]})]},e.id)),0===n.length&&(0,a.jsx)("div",{className:"px-2 py-4 text-center text-sm text-gray-500",children:"No stores available"})]})]}):null}var B=s(3857),Y=s(70489),K=s(83648);function H(){let{currency:e,setCurrency:t}=(0,B.U8)();return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)(Y.Ph,{value:e.code,onValueChange:e=>{let s=B.Mf.find(t=>t.code===e);s&&t(s)},children:[(0,a.jsx)(Y.i4,{className:"w-[120px] h-8 text-sm",children:(0,a.jsx)(Y.ki,{placeholder:"Currency"})}),(0,a.jsx)(Y.Bw,{children:B.Mf.map(e=>(0,a.jsxs)(Y.Ql,{value:e.code,children:[e.symbol," ",e.code]},e.code))})]})]})}var J=s(95777);function Q(){let{data:e}=(0,r.useSession)()||{},t=(0,i.usePathname)(),[s,k]=(0,Z.useState)(!1),[E,I]=(0,Z.useState)(t?.startsWith("/inventory")||t?.startsWith("/suppliers")),[C,R]=(0,Z.useState)(!1),{isPinned:A,setIsPinned:_}=(0,J.Ap)(),O=A||C,P=e?.user?.role,z="ADMIN"===P,D="CASHIER"===P,U="ADMIN"===P||"MANAGER"===P,M=[{name:"Dashboard",href:"/dashboard",icon:o.Z,show:!0},{name:"POS",href:"/pos",icon:l.Z,show:!0},{name:"Products",href:"/products",icon:d.Z,show:U},{name:"Customers",href:"/customers",icon:c.Z,show:U},{name:"Sales",href:"/sales",icon:m.Z,show:!0},{name:"Reports",href:"/reports",icon:o.Z,show:U},{name:"Returns",href:"/returns",icon:u.Z,show:U},{name:"Users",href:"/users",icon:f.Z,show:z},{name:"Settings",href:"/settings/database",icon:x.Z,show:z}],$=[{name:"Stock Management",href:"/inventory",icon:h.Z},{name:"Suppliers",href:"/suppliers",icon:p.Z},{name:"History",href:"/inventory/history",icon:g.Z}],L=M.filter(e=>e.show);return D?(0,a.jsx)("nav",{className:"sticky top-0 z-50 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(n.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"h-8 w-8 text-emerald-600"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gray-900",children:"SuperPOS"})]})}),(0,a.jsx)("div",{className:"hidden md:flex items-baseline space-x-4",children:[{name:"Dashboard",href:"/dashboard",icon:o.Z},{name:"POS",href:"/pos",icon:l.Z},{name:"Sales",href:"/sales",icon:m.Z}].map(e=>{let s=t===e.href,r=e.icon;return(0,a.jsxs)(n.default,{href:e.href,className:`flex items-center space-x-2 rounded-md px-3 py-2 text-sm font-medium transition-colors ${s?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:[(0,a.jsx)(r,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:e.name})]},e.name)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(T,{}),(0,a.jsx)(H,{}),(0,a.jsx)(G,{}),(0,a.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-600",children:e?.user?.name}),(0,a.jsxs)("button",{onClick:()=>(0,r.signOut)({callbackUrl:"/"}),className:"flex items-center space-x-2 rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden md:inline",children:"Logout"})]})]})]})})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("header",{className:"fixed top-0 left-0 right-0 z-50 h-16 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"flex h-full items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>k(!s),className:"mr-4 lg:hidden",children:s?(0,a.jsx)(b.Z,{className:"h-6 w-6"}):(0,a.jsx)(j.Z,{className:"h-6 w-6"})}),(0,a.jsxs)(n.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"h-8 w-8 text-emerald-600"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gray-900",children:"SuperPOS"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(T,{}),(0,a.jsx)(H,{}),(0,a.jsx)(G,{}),(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:e?.user?.name}),(0,a.jsx)("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-700",children:P})]}),(0,a.jsxs)("button",{onClick:()=>(0,r.signOut)({callbackUrl:"/"}),className:"flex items-center space-x-2 rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden md:inline",children:"Logout"})]})]})]})}),(0,a.jsxs)("aside",{onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),className:`fixed top-16 left-0 z-40 h-[calc(100vh-4rem)] border-r border-gray-200 bg-white transition-all duration-300 ${s?"translate-x-0 w-64":"-translate-x-full lg:translate-x-0"} ${O?"w-64":"w-16"}`,children:[(0,a.jsx)("div",{className:"hidden lg:flex items-center justify-end px-3 pt-3",children:(0,a.jsx)("button",{onClick:()=>{_(!A)},className:"p-1.5 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-colors",title:A?"Unpin sidebar":"Pin sidebar",children:A?(0,a.jsx)(v.Z,{className:"h-4 w-4"}):(0,a.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,a.jsx)("nav",{className:`h-full overflow-y-auto px-3 ${O?"py-2":"py-4"}`,children:(0,a.jsxs)("ul",{className:"space-y-1",children:[L.map(e=>{let s=t===e.href,r=e.icon;return(0,a.jsx)("li",{children:(0,a.jsxs)(n.default,{href:e.href,onClick:()=>k(!1),title:O?void 0:e.name,className:`flex items-center rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${s?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"} ${O?"space-x-3":"justify-center"}`,children:[(0,a.jsx)(r,{className:"h-5 w-5 flex-shrink-0"}),O&&(0,a.jsx)("span",{children:e.name})]})},e.name)}),(U||"INVENTORY_CLERK"===P)&&(0,a.jsx)("li",{children:O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>I(!E),className:`flex w-full items-center justify-between rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${t?.startsWith("/inventory")||t?.startsWith("/suppliers")?"bg-emerald-50 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Inventory"})]}),E?(0,a.jsx)(w.Z,{className:"h-4 w-4"}):(0,a.jsx)(S.Z,{className:"h-4 w-4"})]}),E&&(0,a.jsx)("ul",{className:"mt-1 ml-4 space-y-1 border-l border-gray-200 pl-4",children:$.map(e=>{let s=t===e.href,r=e.icon;return(0,a.jsx)("li",{children:(0,a.jsxs)(n.default,{href:e.href,onClick:()=>k(!1),className:`flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors ${s?"bg-emerald-100 text-emerald-700":"text-gray-600 hover:bg-gray-100"}`,children:[(0,a.jsx)(r,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.name})]})},e.name)})})]}):(0,a.jsx)(n.default,{href:"/inventory",title:"Inventory",className:`flex items-center justify-center rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ${t?.startsWith("/inventory")||t?.startsWith("/suppliers")?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:bg-gray-100"}`,children:(0,a.jsx)(h.Z,{className:"h-5 w-5"})})})]})})]}),s&&(0,a.jsx)("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:()=>k(!1)})]})}},95777:function(e,t,s){s.d(t,{Ap:function(){return o},FE:function(){return d},Hn:function(){return l}});var a=s(15444),r=s(75762),n=s(89300);let i=(0,n.createContext)({isPinned:!0,setIsPinned:e=>{}}),o=()=>(0,n.useContext)(i);function l({children:e}){let[t,s]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("sidebar-pinned");null!==e&&s("true"===e)},[]),(0,n.useEffect)(()=>{localStorage.setItem("sidebar-pinned",String(t))},[t]),(0,a.jsx)(i.Provider,{value:{isPinned:t,setIsPinned:s},children:e})}function d({children:e}){let{data:t}=(0,r.useSession)()||{},s=t?.user?.role,{isPinned:n}=o();return"CASHIER"===s?(0,a.jsx)("main",{children:e}):(0,a.jsx)("main",{className:`min-h-screen pt-16 transition-all duration-300 ${n?"lg:ml-64":"lg:ml-16"}`,children:e})}},46271:function(e,t,s){s.d(t,{I:function(){return l}});var a=s(15444),r=s(75762),n=s(79047),i=s(89300),o=s(95854);function l({children:e}){let{data:t,status:s}=(0,r.useSession)()||{},l=(0,n.useRouter)(),d=(0,i.useRef)(!1),c=(0,i.useCallback)(async()=>{if(!t?.user||d.current)return;let e=t.user;if(e.id&&e.sessionToken)try{let t=await fetch("/api/auth/validate-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,sessionToken:e.sessionToken})});(await t.json()).valid||((0,o.Am)({title:"Session Expired",description:"You have been logged out because another session was started.",variant:"destructive"}),await (0,r.signOut)({callbackUrl:"/"})),d.current=!0}catch(e){console.error("Session validation error:",e)}},[t]);return((0,i.useEffect)(()=>{"unauthenticated"===s&&l.replace("/")},[s,l]),(0,i.useEffect)(()=>{if("authenticated"===s&&t?.user){c();let e=setInterval(()=>{d.current=!1,c()},3e4);return()=>clearInterval(e)}},[s,t,c]),"loading"===s)?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-emerald-600"})}):"authenticated"===s?(0,a.jsx)(a.Fragment,{children:e}):null}},61335:function(e,t,s){s.d(t,{C:function(){return o}});var a=s(15444);s(89300);var r=s(2371),n=s(65522);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...s}){return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:t}),e),...s})}},2422:function(e,t,s){s.d(t,{z:function(){return d}});var a=s(15444),r=s(89300),n=s(21030),i=s(2371),o=s(65522);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:t,size:s,asChild:r=!1,...i},d)=>{let c=r?n.g7:"button";return(0,a.jsx)(c,{className:(0,o.cn)(l({variant:t,size:s,className:e})),ref:d,...i})});d.displayName="Button"},70489:function(e,t,s){s.d(t,{Bw:function(){return h},Ph:function(){return c},Ql:function(){return p},i4:function(){return u},ki:function(){return m}});var a=s(15444),r=s(89300),n=s(63280),i=s(63751),o=s(16997),l=s(77248),d=s(65522);let c=n.fC;n.ZA;let m=n.B4,u=r.forwardRef(({className:e,children:t,...s},r)=>(0,a.jsxs)(n.xz,{ref:r,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=n.xz.displayName;let f=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}));f.displayName=n.u_.displayName;let x=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})}));x.displayName=n.$G.displayName;let h=r.forwardRef(({className:e,children:t,position:s="popper",...r},i)=>(0,a.jsx)(n.h_,{children:(0,a.jsxs)(n.VY,{ref:i,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r,children:[(0,a.jsx)(f,{}),(0,a.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,a.jsx)(x,{})]})}));h.displayName=n.VY.displayName,r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=n.__.displayName;let p=r.forwardRef(({className:e,children:t,...s},r)=>(0,a.jsxs)(n.ck,{ref:r,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:t})]}));p.displayName=n.ck.displayName,r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.Z0.displayName},32226:function(e,t,s){s.d(t,{k:function(){return r}});var a=s(89300);function r(){let[e,t]=(0,a.useState)(!0),[s,r]=(0,a.useState)("idle");return(0,a.useEffect)(()=>{t(navigator.onLine);let e=()=>{t(!0),window.dispatchEvent(new Event("sync-transactions"))},s=()=>{t(!1)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),{isOnline:e,syncStatus:s,setSyncStatus:r}}},95854:function(e,t,s){s.d(t,{Am:function(){return m},pm:function(){return u}});var a=s(89300);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function m({...e}){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,t]=a.useState(d);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},3857:function(e,t,s){s.d(t,{Mf:function(){return n},T3:function(){return o},U8:function(){return l}});var a=s(15444),r=s(89300);let n=[{code:"KES",symbol:"KSh",name:"Kenyan Shilling",rate:1},{code:"USD",symbol:"$",name:"US Dollar",rate:.0065},{code:"EUR",symbol:"€",name:"Euro",rate:.006},{code:"GBP",symbol:"\xa3",name:"British Pound",rate:.0051},{code:"TZS",symbol:"TSh",name:"Tanzanian Shilling",rate:16.5},{code:"UGX",symbol:"USh",name:"Ugandan Shilling",rate:24},{code:"ZAR",symbol:"R",name:"South African Rand",rate:.12},{code:"NGN",symbol:"₦",name:"Nigerian Naira",rate:10}],i=(0,r.createContext)(void 0);function o({children:e}){let[t,s]=(0,r.useState)(n[0]),[o,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(!0);let e=localStorage.getItem("pos-currency");if(e){let t=n.find(t=>t.code===e);t&&s(t)}},[]);let d=e=>e*t.rate,c={currency:o?t:n[0],setCurrency:e=>{s(e),localStorage.setItem("pos-currency",e.code)},formatPrice:o?e=>{let s=d(e);return`${t.symbol} ${s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}:e=>`KSh ${e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,convertPrice:o?d:e=>e};return(0,a.jsx)(i.Provider,{value:c,children:e})}function l(){let e=(0,r.useContext)(i);if(!e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},82534:function(e,t,s){s.d(t,{g:function(){return o},o:function(){return l}});var a=s(15444),r=s(89300),n=s(75762);let i=(0,r.createContext)(void 0);function o({children:e}){let{data:t,status:s}=(0,n.useSession)()||{},[o,l]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[m,u]=(0,r.useState)(!0),f=async()=>{try{u(!0);let e=await fetch("/api/stores");if(e.ok){let s=await e.json();if(c(s),t?.user){let e=t.user?.storeId;if(e){let t=s.find(t=>t.id===e);t&&(l(t),localStorage.setItem("selectedStoreId",t.id))}else{let e=localStorage.getItem("selectedStoreId");if(e){let t=s.find(t=>t.id===e);if(t)l(t);else{let e=s.find(e=>e.isActive);e&&(l(e),localStorage.setItem("selectedStoreId",e.id))}}else{let e=s.find(e=>e.isActive);e&&(l(e),localStorage.setItem("selectedStoreId",e.id))}}}}}catch(e){console.error("Error fetching stores:",e)}finally{u(!1)}};return(0,r.useEffect)(()=>{"authenticated"===s?f():"unauthenticated"===s&&u(!1)},[s,t?.user]),(0,a.jsx)(i.Provider,{value:{selectedStore:o,setSelectedStore:e=>{l(e),e?localStorage.setItem("selectedStoreId",e.id):localStorage.removeItem("selectedStoreId")},stores:d,loading:m,refreshStores:f},children:e})}function l(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useStore must be used within a StoreProvider");return e}},65522:function(e,t,s){s.d(t,{cn:function(){return n}});var a=s(32191),r=s(23607);function n(...e){return(0,r.m6)((0,a.W)(e))}}}]);